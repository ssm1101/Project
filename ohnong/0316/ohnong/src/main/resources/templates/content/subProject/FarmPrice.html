<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html
  xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/layoutMagement}">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>oh-nong!</title>
<script src="https://code.jquery.com/jquery-3.6.4.js" integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E=" crossorigin="anonymous"></script>

<style>
 select{
 	height: 50px;
 	width: 200px;
	-webkit-appearance:none;
    background: url(/ohnong/images/icon-search.gif) no-repeat right 6px center;
    background-size: 10px 10px;
    border: 1px solid #C4C4C4;
    box-sizing: border-box;
    border-radius: 10px;
    padding: 12px 13px;
    font-family: 'Roboto';
    font-style: normal;
    font-weight: 400;
    font-size: 14px;
    line-height: 16px;
}
select:focus{
    border: 1px solid gray;
    box-sizing: border-box;
    border-radius: 10px;
    outline: 3px solid gray;
    border-radius: 10px;
}
option {
  padding: 4px;
  font-size: 14px;
  color: #fff;
  background: #272822;
}
</style>
</head>

<th:block layout:fragment="css"> </th:block>
<th:block layout:fragment="script"> </th:block>

<body class="nav-md">
<div layout:fragment="contentMagement">
	<!-- page content -->
        <div class="right_col" role="main">
          <div class="">
            <div class="page-title">
            	<div class="title_left">
					<h3 style="color:black;"><i class="fa fa-leaf"></i> Oh! Nong</h3>
				</div>
            </div>
            <div class="clearfix"></div>
            <div class="row">
              <div class="col-md-12">
                <div class="x_panel">
                  <div class="x_title">
                    <h2>ë†ê°€ ê°€ê²© ì •ë³´<small>ë„ë§¤ì‹œì¥ ì¤‘ë„ë§¤ì¸ ìƒíšŒì—ì„œ ì†Œìƒì¸ ë° ì‹¤ìˆ˜ìš”ìì—ê²Œ íŒë§¤í•˜ëŠ” ê°€ê²©</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a></li>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="#">Settings 1</a>
                            <a class="dropdown-item" href="#">Settings 2</a>
                          </div>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
					<div class="x_content" >
						<div class="row">
							<div class="col-md-12 col-sm-12">
								<div class="x_panel">
										<div>
											<h3><i class="fa fa-bullhorn"></i> ì´ìš©ì•ˆë‚´</h3>
											<div class="table" style="border:1px solid black; padding:20px; font-size:large; ">
											<ul style="margin:0px">
												<li style="color:red;">ë„ë§¤ì‹œì¥ ì¤‘ë„ë§¤ì¸ ìƒíšŒì—ì„œ ì†Œìƒì¸ ë° ì‹¤ìˆ˜ìš”ìì—ê²Œ íŒë§¤í•˜ëŠ” ê°€ê²©ì…ë‹ˆë‹¤. </li>
												<li>ë†ì‚°ë¬¼ íŠ¹ì„±ìƒ í¬ê¸°ì™€ ìƒ‰ìƒ ë“±ì´ ë‹¤ì–‘í•˜ê³  ì €ì¥ê¸°ê°„, ê¸°í›„ë³€í™”ì— ë”°ë¼ ë™ì¼ ë“±ê¸‰ì—ë„ ë‹¤ì†Œ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŒ. </li>
												<li>1ê°œì›”ì „, 1ë…„ì „, í‰ë…„ ê°€ê²©ì€ í•´ë‹¹ì¼ì <strong>ê¸°ì¤€ 5ì¼ ì´ë™í‰ê· </strong> ê°€ê²©ì„. (ì´ë™í‰ê· ì€ í•´ë‹¹ì¼ ê¸°ì¤€ ì „í›„ë¡œ 4~5ì¼ì˜ í‰ê· ê°’) </li>
												<li>í‰ë…„ì€ 5ë…„ê°„(ê¸ˆë…„ ì œì™¸) í•´ë‹¹ì¼ì— ëŒ€í•œ ìµœê³ ê°’ê³¼ ìµœì†Œê°’ì„ ì œì™¸í•œ 3ë…„ í‰ê· ê°’. (í•´ë‹¹ì¼ í‰ê· ê°€ê²©ì€ 5ì¼ ì´ë™í‰ê· ê°’ì„ ì ìš©) </li>
												<li>ì¡°ì‚¬ë‹¨ìœ„ê°€ ì¤‘ëŸ‰ì´ ì•„ë‹Œ í’ˆëª©(í¬ê¸°, ê°œ, ì ‘, ë§ˆë¦¬ ë“±)ì€ kg ë‹¨ìœ„ í™˜ì‚°ì´ ì œê³µë˜ì§€ ì•ŠìŒ. </li>
												<li><strong>ë³¸ ê°€ê²©ìë£ŒëŠ” ì „êµ­ ì£¼ìš” ì‹œì¥ì—ì„œ ì¡°ì‚¬ëœ ë„âˆ™ì†Œë§¤ í‰ê· ê°€ê²©ìœ¼ë¡œ ê°œë³„ íŒë§¤ì²˜ ë° ì‚°ì§€, ë¸Œëœë“œ, ê·œê²© ë“±ì— ë”°ë¼ ê°€ê²©ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ<br> ì‹¤ê±°ë˜ì— ìˆì–´ì„œ ì°¸ê³  ìë£Œë¡œë§Œ í™œìš©í•˜ì—¬ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.</strong> </li>
											</ul>
											</div>
										</div>
										&nbsp
											<h3><i class="fa fa-tasks"></i> ì •ë³´ì¡°íšŒ_ì¡°ì‚¬ì¼ì : [[${result.condition[0]}]]</h3>
											<h2 style="width:50%;float:left;">ğŸ“ˆ ì „ì¼ ëŒ€ë¹„ <span style="color:red;">ìƒìŠ¹</span> í­ì´ í° ëª©ë¡ì…ë‹ˆë‹¤.</h2>	
											<h2 style="width:50%;float:left;">ğŸ“‰ ì „ì¼ ëŒ€ë¹„ <span style="color:blue; ">í•˜ë½</span> í­ì´ í° ëª©ë¡ì…ë‹ˆë‹¤.</h2>
											<div id="pdiv" class="table" style="border:1px solid black; padding:20px; font-size:large; width:50%; height:200px; float:left;	overflow: auto; background-color:#F7F9FA">
											</div>
											<div id="pdiv1" class="table" style="border:1px solid black; padding:20px; font-size:large; width:50%;height:200px; float:left; overflow: auto; background-color:#F7F9FA">
											</div>
										&nbsp
										<h3><i class="fa fa-bar-chart-o"></i> ê²€ìƒ‰ì¡°ê±´ </h3>
										<div>
											<table id="serachTbl" style="padding: 5px; text-align:center;" >
													<colgroup>
														<col style="width: 15%;" />
														<col />
														<col style="width: 10%;" />
														<col />
														<col style="width: 10%;" />
														<col />
													</colgroup>
													<tr>
													<th style="vertical-align:middle;">êµ¬ë¶„ (ë„/ì†Œë§¤)</th>
													<td>
														<select name="searchCNmae" id="searchCNmae" onchange="com_child()">
															<option value=""> ::ì„ íƒí•˜ì„¸ìš”:: </option>
														</select>
													</td>
													<th style="vertical-align:middle;">ë¶€ë¥˜ëª…</th>
													<td>
														<select name="searchBooRyu" id="searchBooRyu" onchange="com_child2()">
															<option value=""> ::ì„ íƒí•˜ì„¸ìš”:: </option>
														</select>
													</td>
													<th style="vertical-align:middle; ">í’ˆëª©ëª…</th>
													<td>
														<select name="searchProduct" id="searchProduct">
															<option value=""> ::ì„ íƒí•˜ì„¸ìš”:: </option>
														</select>
													</td>
												</tr>
											</table>
											<span style="float:right;">(ë‹¨ìœ„ : ì›)</span>
										<div id="show"></div>
										</div>
								</div>
							</div>
							<div id="context"></div>
						</div>
					</div>
              </div>
            </div>
          </div>
        </div>
        <!-- /page content -->
<script th:inline="javascript">

	
let priceList = [[${result.price}]]

const titles =['êµ¬ë¶„','ë¶€ë¥˜ëª…','í’ˆëª©ëª…','ë‹¨ìœ„','ë‹¹ì¼','ë“±ë½ìœ¨','ì „ì¼','1ê°œì›”ì „','1ë…„ì „']
const columns =['product_cls_name','category_name','productName','unit','dpr1','value','dpr2','dpr3','dpr4']


        // # í…Œì´ë¸”ì˜ í—¤ë” ë¶€ë¶„ ìƒì„±
          function makeHead() {
            let thead = document.createElement('thead');
            let tr = document.createElement('tr');

            // titlesì´ ë“¤ì–´ìˆëŠ” ë°°ì—´. ë§¤ê°œê°’ìœ¼ë¡œ í•¨ìˆ˜ê°€ ë“¤ì–´ê°
            titles.forEach(title => {
                let th = document.createElement('th');
                th.innerText = title;
                tr.append(th);
            });
            thead.append(tr);
            return thead;
        }
        // # í…Œì´ë¸”ì˜ ë°”ë”” ë¶€ë¶„ ìƒì„±
        function makeBody(ary = []) { // ë§¤ê°œê°’ì´ ë°°ì—´ì„
            let tbody = document.createElement('tbody');

            // ê±´ìˆ˜ë§Œí¼ trë¡œ ìƒì„±
            ary.forEach(center => { // ë§¤ê°œê°’ ìˆœì„œ : ìš”ì†Œ, ì¸ë±ìŠ¤, ë°°ì—´
                tbody.append(makeTr(center));
            });
            return tbody;
        }
        // # tr ìƒì„±
        function makeTr(center = {}) { // ë§¤ê°œê°’ì´ ê°ì²´ì„
            let tr = document.createElement('tr');
			
            columns.forEach(field => {
                let td = document.createElement('td');
                
            		
               if(field == 'value') {
                	let val = center.value
                	let direction = center.direction;
                	let iTag = document.createElement('i');
                	let percent = document.createElement('span');
                	percent.innerText = '%';
                	
                		if(direction == 1){
                			iTag.classList.add('fa');
    						iTag.classList.add('fa-long-arrow-up');
    						iTag.setAttribute('style', 'color:red');
                			td.setAttribute('style', 'color:red');
                		} else if(direction == 0){
                			iTag.classList.add('fa');
    						iTag.classList.add('fa-long-arrow-down');
    						iTag.setAttribute('style', 'color:blue');
                			td.setAttribute('style', 'color:blue');
                		} else if(direction == 2){}
                		if(direction==1 && val > 4){
                			let pTag = $('<p>')
                			let pName = center.productName
                			let cType = center.product_cls_name
                			pTag.text(cType+"_"+pName +" " +'_ì „ì¼ê³¼ ' + val +"% ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.")
                			$('#pdiv').append(pTag);
                		}
                		if(direction==0 && val > 4){
                			let pTag = $('<p>')
                			let pName = center.productName
                			let cType = center.product_cls_name
                			pTag.text(cType+"_"+pName +" " +'_ì „ì¼ê³¼ ' + val +"% ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.")
                			$('#pdiv1').append(pTag);
                		}
                	td.innerText = center[field];
                	td.append(percent)
                	td.append(iTag)
                	
                }
                else{
                	td.innerText = center[field];
                }
                tr.append(td);
            })
            return tr;
        }

        let table;
        let prices = []; 
        let clsNameAry = [];
        let booRyuAry = [];
        let productAry = [];
        let productAry100 = [];
        let productAry200 = [];
        let productAry300 = [];
        let productAry400 = [];
        let productAry500 = [];
        let productAry600 = [];
        
        table = document.createElement('table');

        prices = priceList;
         // select option ì¶”ê°€í•˜ê¸°
         for (let price of prices) {
             //ë°°ì—´. indexOf() ì‚¬ìš©í•˜ì—¬ ê°’ì´ ìˆëŠ”ì§€ í™•ì¸ í›„ optionê°’ ì¶”ê°€
             if (clsNameAry.indexOf(price.product_cls_name) == -1) {
            	 clsNameAry.push(price.product_cls_name);
             }
             if (booRyuAry.indexOf(price.category_name) == -1) {
            	 booRyuAry.push(price.category_name);
             }

        	 if (productAry.indexOf(price.productName) == -1) {
        		 if(price.category_code == '100'){
        		 	productAry100.push(price.productName);
        		 } else if(price.category_code == '200'){
        			 productAry200.push(price.productName);
        		 } else if(price.category_code == '300'){
        			 productAry300.push(price.productName);
        		 } else if(price.category_code == '400'){
        			 productAry400.push(price.productName);
        		 } else if(price.category_code == '500'){
        			 productAry500.push(price.productName);
        		 } else if(price.category_code == '600'){
        			 productAry600.push(price.productName);
        		 }
        	}
         }
         
         function com_parent(){
        	    let opt = [];
        	    opt.push(`<option value="" selected>:: ì„ íƒí•˜ì„¸ìš” ::</option>`)
        	    clsNameAry.forEach(data =>{
        	        opt.push(`<option value="${data}">${data}</option>`);
        	    });
        	    document.getElementById("searchCNmae").innerHTML = opt.join("");
        	}

         function com_child(){
             let opt = [];
             let oneSel = document.getElementById("searchCNmae").value;
             
             if( oneSel == ""){
            	 opt.push(`<option value="" selected>:: ì„ íƒí•˜ì„¸ìš” ::</option>`)
             } else if( oneSel == "ë„ë§¤"){
            	 opt.push(`<option value="" selected>:: ì„ íƒí•˜ì„¸ìš” ::</option>`)
            	 booRyuAry.forEach(data =>{
                       opt.push(`<option value="${data}">${data}</option>`);
                   });
             } else if( oneSel == "ì†Œë§¤"){
            	 opt.push(`<option value="" selected>:: ì„ íƒí•˜ì„¸ìš” ::</option>`)
            	 booRyuAry.forEach(data =>{
               		 opt.push(`<option value="${data}">${data}</option>`);
                    });
                }
             document.getElementById("searchBooRyu").innerHTML = opt.join("");
             }
         
         function com_child2(){
        	 let opt = [];
        	 let towSel = document.getElementById("searchBooRyu").value;
        	 
        	 if( towSel == ""){
        		 opt.push(`<option value="" selected>:: ì„ íƒí•˜ì„¸ìš” ::</option>`)
        	 } else if( towSel == "ì‹ëŸ‰ì‘ë¬¼" ){
        		 opt.push(`<option value="" selected>:: ì„ íƒí•˜ì„¸ìš” ::</option>`)
        			 productAry100.forEach(data =>{
                         opt.push(`<option value="${data}">${data}</option>`);
                     });
        	} else if ( towSel == "ì±„ì†Œë¥˜" ){
        		opt.push(`<option value="" selected>:: ì„ íƒí•˜ì„¸ìš” ::</option>`)
        			 productAry200.forEach(data =>{
                         opt.push(`<option value="${data}">${data}</option>`);
                     });
        	} else if ( towSel == "íŠ¹ìš©ì‘ë¬¼" ){
        		opt.push(`<option value="" selected>:: ì„ íƒí•˜ì„¸ìš” ::</option>`)
        			 productAry300.forEach(data =>{
                         opt.push(`<option value="${data}">${data}</option>`);
                     });
        	} else if ( towSel == "ê³¼ì¼ë¥˜" ){
        		opt.push(`<option value="" selected>:: ì„ íƒí•˜ì„¸ìš” ::</option>`)
        			 productAry400.forEach(data =>{
                         opt.push(`<option value="${data}">${data}</option>`);
                     });
        	} else if ( towSel == "ì¶•ì‚°ë¬¼" ){
        		opt.push(`<option value="" selected>:: ì„ íƒí•˜ì„¸ìš” ::</option>`)
        			 productAry500.forEach(data =>{
                         opt.push(`<option value="${data}">${data}</option>`);
                     });
        	} else if ( towSel == "ìˆ˜ì‚°ë¬¼" ){
        		opt.push(`<option value="" selected>:: ì„ íƒí•˜ì„¸ìš” ::</option>`)
        			 productAry600.forEach(data =>{
                         opt.push(`<option value="${data}">${data}</option>`);
                     });
        	}
        	    document.getElementById("searchProduct").innerHTML = opt.join("");
         }
         
         com_parent();

         table.append(makeHead(), makeBody(prices));
         table.classList.add('table');
         table.classList.add('table-striped');
         table.classList.add('jambo_table');
         document.getElementById('show').append(table);

         
     	// ë„/ì†Œë§¤ë³„ ì¡°íšŒ
        document.getElementById('searchCNmae').addEventListener('change', function () {
              document.querySelector('#show tbody').remove();
              let searchCNmae = [];
              let keyword = document.getElementById('searchCNmae').value;
              for (let price of prices) {
                  if (price.product_cls_name == keyword) {
                 	 searchCNmae.push(price);
                  }
              }
              document.querySelector('#show table').append(makeBody(searchCNmae));
          });
     	
       	// ë¶€ë¥˜ë³„ ì¡°íšŒ
        document.getElementById('searchBooRyu').addEventListener('change', function () {
             document.querySelector('#show tbody').remove();
             let searchBooRyu = [];
             let keyword1 = document.getElementById('searchCNmae').value;
             let keyword2 = document.getElementById('searchBooRyu').value;
             for (let price of prices) {
            	 if (price.product_cls_name == keyword1) {
            		 if(price.category_name == keyword2){
            			 searchBooRyu.push(price);
            		 }
            	 }
             }
             document.querySelector('#show table').append(makeBody(searchBooRyu));
         });
      
         // í’ˆëª©ë³„ ì¡°íšŒ
         document.getElementById('searchProduct').addEventListener('change', function () {
             document.querySelector('#show tbody').remove();
             let searchProduct = [];
             let keyword1 = document.getElementById('searchCNmae').value;
             let keyword2 = document.getElementById('searchBooRyu').value;
             let keyword3 = document.getElementById('searchProduct').value;
             for (let price of prices) {
            	 if (price.product_cls_name == keyword1) {
            		 if(price.category_name == keyword2){
            			 if(price.productName == keyword3){
            				 searchProduct.push(price);
            			 }
            		 }
            		 
            	 }
            	 
             }
             document.querySelector('#show table').append(makeBody(searchProduct));
         });
         
</script>
</div>
</div>
</body>
</html>