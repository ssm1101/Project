<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout/layoutMagement}">
<head>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.js"></script>

<meta charset="UTF-8">
<title>oh-nong!</title>
<style>
.stepContainer {
    overflow: hidden;
}
.input-file-button {
  padding: 10px 25px;
  height: 40px;
  background-color:#ffc107;
  border-radius: 4px;
  color: black;
  cursor: pointer;
}
</style>
</head>
</th:block>
<th:block layout:fragment="script">
</th:block>
<div layout:fragment="contentMagement">

    <div class="right_col" role="main">
        <div class="">
            <div class="page-title">
                <div class="title_left">
                </div>
            </div>

            <div class="clearfix"></div>

            <div class="row">
                <div class="col-md-12 col-sm-12 ">
                  <h3 style="text-align:left"><b>üìó ÎÜçÍ∞Ä Îì±Î°ù</b></h3>
                    <div class="x_panel">
                        <div class="x_title">
                            <ul class="nav navbar-right panel_toolbox">
                                <li><a class="collapse-link"><i
                                        class="fa fa-chevron-up"></i></a></li>
                                <li class="dropdown"><a href="#" class="dropdown-toggle"
                                    data-toggle="dropdown" role="button" aria-expanded="false"><i
                                        class="fa fa-wrench"></i></a>
                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                        <a class="dropdown-item" href="#">Settings 1</a> <a
                                            class="dropdown-item" href="#">Settings 2</a>
                                    </div></li>
                                <li><a class="close-link"><i class="fa fa-close"></i></a></li>
                            </ul>
                            <div class="clearfix"></div>
                        </div>

                        <div class="x_content">
                        <form class="form-horizontal form-label-left" name="form" th:role="form" th:action="@{farmRegister}" method="POST" enctype="multipart/form-data">
                            <div id="wizard" class="form_wizard wizard_horizontal">
                                <ul class="wizard_steps anchor">
                                    <li><a href="#step-1" class="selected" isdone="1" rel="1">
                                            <span class="step_no" ><b>1</b></span> <span class="step_descr" style="font-size: 17px; importent!">
                                                <b>Step 1</b><br><small><b>ÌïÑÏàò ÏûÖÎ†• ÏÇ¨Ìï≠</b></small>
                                        </span>
                                    </a></li>
                                    <li><a href="#step-2" class="done" isdone="1" rel="2">
                                            <span class="step_no" ><b>2</b></span> <span class="step_descr" style="font-size: 17px; importent!">
                                                <b>Step 2</b><br><small><b>ÏÑ†ÌÉù ÏûÖÎ†• ÏÇ¨Ìï≠</b></small>
                                        </span>
                                    </a></li>
                                    <li><a href="#step-3" class="disabled" isdone="0" rel="3">
                                            <span class="step_no" ><b>3</b></span> <span class="step_descr" style="font-size: 17px; importent!">
                                                <b>Step 3</b><br><small><b>Í∞ÄÏûÖ ÏôÑÎ£å / ÏïàÎÇ¥</b></small>
                                        </span>
                                    </a></li>
                                </ul>

                                <div class="stepContainer" style="height: 350px;">
                                    
                                        <div id="step-1" class="content" style="display: block;">
                                            <!-- ÏïÑÏù¥Îîî ÏïÑÏù¥Îîî ÏïÑÏù¥Îîî ÏïÑÏù¥Îîî ÏïÑÏù¥Îîî -->
                                            <input type="hidden" id="userId" name="userId"
                                                        class="form-control " th:value="${session.login.userId}">
                                             <!-- ÏïÑÏù¥Îîî ÏïÑÏù¥Îîî ÏïÑÏù¥Îîî ÏïÑÏù¥Îîî ÏïÑÏù¥Îîî -->
                                            <div style="margin: 0 250px;"><h2><b>‚úÖÌïÑÏàò ÏûÖÎ†•</b></h2></div>
                                            <div class="form-group row">
                                                <label class="col-form-label col-md-3 col-sm-3 label-align"
                                                    for="farmName"><b>ÎÜçÍ∞Ä(ÏÉÅÌò∏Î™Ö)</b> <span class="required">*</span>
                                                </label>
                                                <div class="col-md-6 col-sm-6 ">
                                                    <input type="text" id="farmName" name="farmName"
                                                        class="form-control ">
                                                        
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label class="col-form-label col-md-3 col-sm-3 label-align"
                                                    for="farmCeo"><b>ÎåÄÌëúÎ™Ö</b><span class="required">*</span>
                                                </label>
                                                <div class="col-md-6 col-sm-6 ">
                                                    <input type="text" id="farmCeo" name="farmCeo"
                                                        class="form-control ">
                                                </div>
                                            </div>

                                            <!-- Ï≤®Î∂ÄÌååÏùº Ï≤òÎ¶¨ -->
                                            <div class="form-group row">
                                                <label for="farmDocument"
                                                    class="col-form-label col-md-3 col-sm-3 label-align"><b>ÎÜçÏßÄÏ∑®ÎìùÏÑú</b><span
                                                    class="required">*</span></label>
                                                <div class="col-md-6 col-sm-4 " style="height: 40px;">
                                                    <div class="panel-body">
                                                        <div class="form-group uploadDiv">
                                                        <label for="uploadFile" class="input-file-button"><b>ÌååÏùº Ï≤®Î∂Ä</b></label>
                                                            <input type="file" name="uploadFile" id="uploadFile" multiple style="display: none">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div> 

                                            <div class="form-group row">
                                                <label for="farmAddr"
                                                    class="col-form-label col-md-3 col-sm-3 label-align"><b>ÏßÄÏó≠</b><span
                                                    class="required">*</span></label>
                                                <div class="col-md-6 col-sm-6 ">
                                                <input type="hidden" name="farmAddr" id="farmAddr">
                                                <input type="radio" name="radio" id="r1" value="ÎåÄÍµ¨" checked><b>ÎåÄÍµ¨</b>
                                                <input type="radio" name="radio" id="r2" value="Í≤ΩÎ∂Å"><b>Í≤ΩÎ∂Å</b>
                                                &nbsp;
                                                    <span id="spanId">
                                                    <select id="farmAddr1" th:onchange="changeSelect()" style="height: 37px; font-weight: bold">
                                                        <option value="">ÏßÄÏó≠ ÏÑ†ÌÉù</option>
                                                        <option th:value="ÎåÄÍµ¨-Î∂ÅÍµ¨ ">Î∂ÅÍµ¨</option>
                                                        <option th:value="ÎåÄÍµ¨-ÎèôÍµ¨ ">ÎèôÍµ¨</option>
                                                        <option th:value="ÎåÄÍµ¨-Ï§ëÍµ¨ ">Ï§ëÍµ¨</option>
                                                        <option th:value="ÎåÄÍµ¨-ÏÑúÍµ¨ ">ÏÑúÍµ¨</option>
                                                        <option th:value="ÎåÄÍµ¨-Îã¨ÏÑúÍµ¨ ">Îã¨ÏÑúÍµ¨</option>
                                                        <option th:value="ÎåÄÍµ¨-ÏàòÏÑ±Íµ¨ ">ÏàòÏÑ±Íµ¨</option>
                                                        <option th:value="ÎåÄÍµ¨-ÎÇ®Íµ¨ ">ÎÇ®Íµ¨</option>
                                                        <option th:value="ÎåÄÍµ¨-Îã¨ÏÑ±Íµ∞ ">Îã¨ÏÑ±Íµ∞</option>
                                                    </select>
                                                    </span>
                                                    <span id="spanId2">
                                                    <select id="farmAddr2" th:onchange="changeSelect()" style="height: 37px; font-weight: bold">
                                                        <option value="">ÏßÄÏó≠ ÏÑ†ÌÉù</option>
                                                        <option th:value="Í≤ΩÎ∂Å-Ìè¨Ìï≠Ïãú ">Ìè¨Ìï≠Ïãú</option>
                                                        <option th:value="Í≤ΩÎ∂Å-Í≤ΩÏ£ºÏãú ">Í≤ΩÏ£ºÏãú</option>
                                                        <option th:value="Í≤ΩÎ∂Å-ÏïàÎèôÏãú ">ÏïàÎèôÏãú</option>
                                                        <option th:value="Í≤ΩÎ∂Å-ÍπÄÏ≤úÏãú ">ÍπÄÏ≤úÏãú</option>
                                                        <option th:value="Í≤ΩÎ∂Å-Íµ¨ÎØ∏Ïãú ">Íµ¨ÎØ∏Ïãú</option>
                                                        <option th:value="Í≤ΩÎ∂Å-ÏòÅÏ£ºÏãú ">ÏòÅÏ£ºÏãú</option>
                                                        <option th:value="Í≤ΩÎ∂Å-ÏòÅÏ≤úÏãú ">ÏòÅÏ≤úÏãú</option>
                                                        <option th:value="Í≤ΩÎ∂Å-ÏÉÅÏ£ºÏãú ">ÏÉÅÏ£ºÏãú</option>
                                                        <option th:value="Í≤ΩÎ∂Å-Î¨∏Í≤ΩÏãú ">Î¨∏Í≤ΩÏãú</option>
                                                        <option th:value="Í≤ΩÎ∂Å-Í≤ΩÏÇ∞Ïãú ">Í≤ΩÏÇ∞Ïãú</option>
                                                    </select>
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label class="col-form-label col-md-3 col-sm-3 label-align"><b>Ïû¨Î∞∞Î©¥Ï†Å</b>
                                                    <span class="required">*</span>
                                                </label>
                                                <div class="col-md-6 col-sm-6 ">
                                                    <input id="plantArea" name="plantArea" class="date-picker form-control"
                                                        type="text" placeholder="ÌèâÏàò ÏûÖÎ†•" value="">
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="middlecatagori"
                                                    class="col-form-label col-md-3 col-sm-3 label-align"><b>ÎåÄÌëú
                                                    ÏûëÎ¨º</b><span class="required">*</span>
                                                </label> 
                                                    &nbsp;&nbsp;&nbsp;
                                                    <select name="middlecatagori" id="middlecatagori" style="font-weight: bold">
                                                        <option value="">Î∂ÑÎ•ò ÏÑ†ÌÉù</option>
                                                        <option th:value="Í≥°Î•ò">Í≥°Î•ò</option>
                                                        <option th:value="ÏΩ©Î•ò">ÏΩ©Î•ò</option>
                                                        <option th:value="Íµ¨Í∑ºÎ•ò">Íµ¨Í∑ºÎ•ò</option>
                                                        <option th:value="Ï±ÑÏÜåÎ•ò">Ï±ÑÏÜåÎ•ò</option>
                                                        <option th:value="Í≥ºÏã§Î•ò">Í≥ºÏã§Î•ò</option>
                                                        <option th:value="Ï¢ÖÏã§Î•ò">Ï¢ÖÏã§Î•ò</option>
                                                        <option th:value="Î≤ÑÏÑØÎ•ò">Î≤ÑÏÑØÎ•ò</option>
                                                    </select>
                                                &nbsp;    
                                                <div class="col-md-5 col-sm-6 ">    
                                                    <input id="subdivision" name="subdivision"
                                                        class="date-picker form-control" type="text"
                                                        placeholder="ÏûëÎ¨º ÏûÖÎ†•" value="">
                                                </div>
                                            </div>
                                        </div>

                                        <div id="step-2" class="content" style="display: none;">
                                            <div style="margin: 0 250px;"><h2><b>‚úÖÏÑ†ÌÉù ÏûÖÎ†•</b></h2></div>
                                            <div class="form-group row">
                                                <label for="farmDetailaddr"
                                                    class="col-form-label col-md-3 col-sm-3 label-align"><b>ÏÉÅÏÑ∏Ï£ºÏÜå</b>
                                                    <span class="required">*</span>
                                                </label>
                                                <div class="col-md-6 col-sm-6 ">
                                                    <input id="farmDetailaddr" name="farmDetailaddr"
                                                        class="date-picker form-control" type="text">
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="homepage"
                                                    class="col-form-label col-md-3 col-sm-3 label-align"><b>ÌôàÌéòÏù¥ÏßÄ</b>
                                                    <span class="required">*</span>
                                                </label>
                                                <div class="col-md-6 col-sm-6 ">
                                                    <input id="homepage" name="homepage"
                                                        class="date-picker form-control" type="text">
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="registNum"
                                                    class="col-form-label col-md-3 col-sm-3 label-align"><b>ÏÇ¨ÏóÖÏûêÎì±Î°ùÎ≤àÌò∏</b>
                                                    <span class="required">*</span>
                                                </label>
                                                <div class="col-md-6 col-sm-6 ">
                                                    <input id="registNum" name="registNum"
                                                        class="date-picker form-control" type="text">
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="memo"
                                                    class="col-form-label col-md-3 col-sm-3 label-align"><b>Î©îÎ™®</b>
                                                    <span class="required">*</span>
                                                </label>
                                                <div class="col-md-6 col-sm-6 ">
                                                    <textarea id="memo"
                                                        class="form-control" name="memo"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    

                                    <div id="step-3" class="content" style="display: none;">
                                        <h2 class="StepTitle" style="font-size: 25px"><b>‚úÖÎì±Î°ù ÏïàÎÇ¥</b></h2>
                                        <p style="font-size: 18px"><b>ÎÜçÍ∞Ä Îì±Î°ù Ïã†Ï≤≠ÏùÑ ÌïòÏãúÎ©¥ <span style="color:green">Îã§Ïùå ÎÇ† Ï†ïÏò§ Ï†ÑÍπåÏßÄ(Ï£ºÎßêÏù∏ Í≤ΩÏö∞ Ï†úÏô∏)</span> ÎÜçÍ∞Ä Îì±Î°ù ÏäπÏù∏ Ïó¨Î∂Ä Í≤∞Ï†ïÏù¥ Îê©ÎãàÎã§. ÏäπÏù∏Ïù¥ ÏôÑÎ£åÎêòÎ©¥
                                            ÌôàÌéòÏù¥ÏßÄ ÎÇ¥ Îã§ÏñëÌïú Í∏∞Îä•ÏùÑ Ïù¥Ïö©Ìï† Ïàò ÏûàÏäµÎãàÎã§. Í∞êÏÇ¨Ìï©ÎãàÎã§.</b></p>
                                        <p><b>If you apply for farmhouse registration A decision on
                                            whether to approve farmhouse registration will be made by
                                            midnight today. Once approval is complete, you can use
                                            various functions on the homepage. thank you.</b></p>
                                <button id="submit" type="submit" class="btn btn-warning"><b>Îì±Î°ùÌïòÍ∏∞</b></button>
                                    </div>
                                </div>
                            </div>
                            </form>
                        </div>
                        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
                        <script>
                        var userId = $('#userId').val();
                        
                        function validation() {
                        	console.log('ÌÅ¥Î¶≠');
                        	
                        	if($('#farmName').val() == '' || $('#farmCeo').val() == ''
                        	|| $('#farmAddr').val() == '' || $('#plantArea').val() == '' 
                        	|| $('#middlecatagori').val() == '' || $('#subdivision').val() == '') {
                        		alert('ÏûÖÎ†•Í∞íÏùÑ Î™®Îëê Ï†ÅÏñ¥Ï£ºÏÑ∏Ïöî.');
                        		return false;
                            }
                        	
                        	if($('#uploadFile').val() == "") {
                        		alert("Ï≤®Î∂ÄÌååÏùºÏùÄ ÌïÑÏàòÏûÖÎãàÎã§!");
                        	    $("#uploadFile").focus();
                        	    return false;
                        	}
                        	
                        	var farmName = $('#farmName').val();
                        	
                        	$.ajax({
                                type : 'get',
                                url : '/ohnong/checkFarm', // ÏÑúÎ≤Ñ ÏöîÏ≤≠ url
                                headers : {
                                    'Content-Type' : 'application/json'
                                },
                                dataType : 'text', // ÏÑúÎ≤ÑÎ°úÎ∂ÄÌÑ∞ ÏùëÎãµÎ∞õÏùÑ Îç∞Ïù¥ÌÑ∞ ÌòïÌÉú 
                                data : {"farmName" : farmName}, // ÏÑúÎ≤ÑÎ°ú Ï†ÑÏÜ°Ìï† Îç∞Ïù¥ÌÑ∞. const id 
                                async: false,
                                success : function(result) { // ÌÜµÏã† ÏÑ±Í≥µ Ïãú Îß§Í∞úÎ≥ÄÏàòÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                                    console.log('ÌÜµÏã† ÏÑ±Í≥µ ' + result);
                                    if(result === 'available') {
                                        true;
                                    } else {
                                    	const Toast = Swal.mixin({
                                            toast: true,
                                            position: 'center-center',
                                            showConfirmButton: false,
                                            timer: 3000,
                                            timerProgressBar: true,
                                            didOpen: (toast) => {
                                              toast.addEventListener('mouseenter', Swal.stopTimer)
                                              toast.addEventListener('mouseleave', Swal.resumeTimer)
                                            }
                                          })
                                          Toast.fire({
                                            icon: 'warning',
                                            title: 'Ïù¥ÎØ∏ Îì±Î°ùÎêú ÎÜçÍ∞ÄÏûÖÎãàÎã§.'
                                          })
                                        false;
                                    }
                                },
                                error : function(status, error) {
                                    console.log('ÌÜµÏã† Ïã§Ìå®');
                                    console.log(status, error);
                                }
                                })
                                
                        	return true;
                        }
                        
                        $(document).ready(function(e) {
                        	
                        	$('#spanId2').hide();
                            $("input:radio[name=radio]").click(function(){
                                if($("input[name=radio]:checked").val() == "ÎåÄÍµ¨"){
                                    $('#spanId').show();
                                    $('#spanId2').hide();
                                }
                                if($("input[name=radio]:checked").val() == "Í≤ΩÎ∂Å"){
                                    $('#spanId').hide();
                                    $('#spanId2').show();
                                }
                            })
                            
                            //// ÌååÏùº ÏóÖÎ°úÎìú ////
							// ÌååÏùº ÌÅ¨Í∏∞ ÏßÄÏ†ï, ÌôïÏû•Ïûê Ï†úÌïú
							var regex = new RegExp("(.*?)\.(jpg|jpeg|png|gif|bmp|pdf)$");
							var maxSize = 5242880; // 5MB

                            // ÌååÏùº Ï≤¥ÌÅ¨
							function checkExtension(fileName, fileSize) {
								if (fileSize > maxSize) {
									alert('ÌååÏùº ÏÇ¨Ïù¥Ï¶à Ï¥àÍ≥º');
									return false;
								}
								if (!regex.test(fileName)) {
									alert('Ïù¥ÎØ∏ÏßÄ ÌååÏùºÎßå ÏóÖÎ°úÎìú Í∞ÄÎä•Ìï©ÎãàÎã§.');
									return false;
								}
								return true;
							}

                            // Ï≤®Î∂ÄÌååÏùº ÏÑ†ÌÉù Ïãú change Ïù¥Î≤§Ìä∏
							$("input[type='file']").change(function () {

                                console.log('c');
                                
                                var file = document.getElementById('uploadFile').files[0];
                                var reader = new FileReader();

                                console.log(file);
                              
                                if (file) {
                                    reader.readAsDataURL(file);
                                } 
                            })
                                                        
                            // Ïû¨Î∞∞ Î©¥Ï†Å
							const input = document.querySelector('#plantArea');
							
							input.addEventListener('keyup', function(e) {
							  let value = e.target.value;
							  value = Number(value.replaceAll(',', ''));
							  if(isNaN(value)) {
							    input.value = 0;
							  } else {
							    const formatValue = value.toLocaleString('ko-KR');
							    input.value = formatValue;
							  }
							})
                        })
                        
                        function changeSelect() {
                            var selectvalue = "";
                            
                            if($("input[name=radio]:checked").val() == "ÎåÄÍµ¨") {
                                selectvalue = $('#farmAddr1').val();
                            } else {
                                selectvalue = $('#farmAddr2').val();
                            }
                            $('#farmAddr').val(selectvalue);
                            
                        }
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</html>