<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layoutMagement}">
<head>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.js"></script>
<meta charset="UTF-8">

<style>

.pageInfo_area{
    text-align: center;
    width: 50%;
}
.pagination2{
    list-style: none;
    display: inline-block;
    padding: 0;
    margin-top: 20px;
}

.pagination2 li {
    display: inline;
    text-align: center;
}
/*ìˆ«ì*/ 
.pagination2 a {
    float: left;
    display: block;
    font-size: 14px;
    text-decoration: none;
    padding: 5px 12px;
    color: #96a0ad;
    line-height: 1.5;
}
.pagefirst{
    margin-right: 15px;
}
.pagelast{
    margin-left: 15px;
}
.pagefirst:hover, .pagelast:hover, .arrowright:hover, .arrowleft:hover, .model .num:hover{
    color:#2e9cdf;
}
.pagination2 .move.active{
    cursor: default;
    color: #ffffff;
}
.pagination2 .move:active{
    outline: none;
}
.model .num {
    margin-left: 3px;
    padding: 0;
    width: 30px;
    height: 30px;
    line-height: 30px;
    -moz-border-radius: 100%;
    -webkit-border-redius:100%;
    border-radius: 100%;
}
.model .num.active, .model .num:active{
    background-color: #2e9cdf;
    cursor: pointer;
}
.arrowleft{
    width: 0;
    height: 0;
    border-top: 10px solid transparent;
    border-bottom: 10px solid transparent;
    border-right: 10ox solid blue;
}

 a.active {
 	cursor:default;
 	color:#ffffff; 	
 }

  
  .search_area{
    text-align:center;
  }
  .search_area input{
    height: 30px;
    width: 250px;
  }
  .search_area button{
    height: 30px;
    width: 100px;
  }
   .search_area select{
  	height: 30px;
    width:150px;
  }
 .move:link {color: #2e9cdf; text-decoration: none; }
 .move:visited {color:purple;,text-decoration: overline;}
 .move:hover {color:#bbb;,text-decoration: underline;}
 
</style>
</head>
</th:block>
<th:block layout:fragment="script">
</th:block>
<div layout:fragment="contentMagement">
	<style type="text/css">
	/* Chrome, Safari, Edge, Opera */
	input::-webkit-outer-spin-button,
	input::-webkit-inner-spin-button {
	  -webkit-appearance: none;
	  margin: 0;
	}
	
	/* Firefox  */
	input[type='number'] {
	  -moz-appearance: textfield;
	}
	td {
		font-weight: bold;
	}
	</style>
	<!-- page content -->
	<div class="right_col" role="main">
		<div class="">
			<div class="col-md-12 col-sm-12  ">
				<!-- ê²€ìƒ‰ê¸°ëŠ¥ -->
				<div class="x_panel">
					<div class="x_title">
						<h4 style="color:black;font-weight: bold;">ğŸ“ƒ ë¶ˆëŸ‰í’ˆëª© ê´€ë¦¬</h4>
						<div class="clearfix"></div>
					</div>
					<div class="clearfix"></div>
					<!--  
						<div style="display: inline-block">
							<p>ë†ê°€ì´ë¦„
							<input type="text" id="farmName" th:value="ë†ê°€1" readonly>
							</p>
						</div>
						<div style="display: inline-block">
							<p>ë“±ë¡ì
							<input type="text" id="userName" th:value="user1" readonly>
							</p>
						</div>
					-->	
					<div>
						<form id="SearchForm" th:action="@{/defectiveList}" method="get" th:onSubmit="return check()">
							<div style="display: inline-block">
								<p><span style="font-weight: bold; color:black; font-size: 16px; margin-right: 10px;">í’ˆëª©</span>
								<select th:name="middleCatagori" id="catagoriSelect" style="border-radius: 4px; height: 25px; font-weight: bold; color:black; margin-bottom: 10px;">
									<option value="">ë¶„ë¥˜ì„ íƒ</option>
									<option th:value="ê³¡ë¥˜">ê³¡ë¥˜</option>
									<option th:value="ì½©ë¥˜">ì½©ë¥˜</option>
									<option th:value="êµ¬ê·¼ë¥˜">êµ¬ê·¼ë¥˜</option>
									<option th:value="ì±„ì†Œë¥˜">ì±„ì†Œë¥˜</option>
									<option th:value="ê³¼ì‹¤ë¥˜">ê³¼ì‹¤ë¥˜</option>
									<option th:value="ì¢…ì‹¤ë¥˜">ì¢…ì‹¤ë¥˜</option>
									<option th:value="ë²„ì„¯ë¥˜">ë²„ì„¯ë¥˜</option>
								</select>
							
								<input type="text" name="name" placeholder="í’ˆëª©ëª…" id="cropName" style="border-radius: 4px; border: 1px solid black;height: 25px; margin-left: 10px; margin-right: 100px;"/>
								</p>
							</div>
							<div style="display: inline-block">  
								<p><span style="font-weight: bold; color:black; font-size: 16px; margin-right: 10px;">ë“±ë¡ê¸°ê°„</span>	
						    	<input name="startDate" type="date" id="startDate" style="border-radius: 4px; border: 1px solid black;height: 25px;padding: 0 10px;">
							    <span style="font-weight: bold; color:black; font-size: 16px; margin-right: 10px;">&nbsp&nbspã…¡&nbsp&nbsp</span>
							    <input name="endDate" type="date" id="endDate" style="border-radius: 4px; border: 1px solid black;height: 25px;padding: 0 10px;">
						  		</p>
						    </div>
						    <br>
						    <div style="display: inline-block;vertical-align:middle;">
								<p><span style="font-weight: bold; color:black; font-size: 16px; margin-right: 10px;">ì°½ê³ </span>
								<select th:name="warehouseCode" id="warehouseSelect" style="border-radius: 4px; height: 25px; font-weight: bold; color:black; margin-bottom: 10px;">
									<option value="0">-----------ì°½ê³ ì„ íƒ-----------</option>
									<th:block th:each="warehouseInfo : ${warehouseList }">
										<option th:value="${warehouseInfo.warehouseCode }" th:selected="${warehouseInfo.warehouseCode} eq ${cri.warehouseCode}">[[${warehouseInfo.warehouseName }]]</option>
									</th:block>
								</select>
								<input type="hidden" name="amount" th:value="${pageInfo.cri.amount }"/>
								<input type="hidden" name="pageNum" th:value="${pageInfo.cri.pageNum }"/>
								<button id="searchSubmit" type="submit" class="btn btn-secondary btn-sm" style="border: none; font-weight: bold; color:white; background: #2A3F54; height: 25px; padding:0 15px; margin-left: 25px;">ì¡°íšŒ</button>
								<button id="searchReset" type="reset" class="btn btn-secondary btn-sm" style="border: none; font-weight: bold; color:white; background: #2A3F54; height: 25px; padding:0 15px; margin-left: 5px;">ì´ˆê¸°í™”</button>
								</p>
							</div>
						</form>
					</div>
					
					<!-- í…Œì´ë¸” -->
					<div class="x_title">
						<h5 style="color:black;font-weight: bold;">ğŸŒ½ ë¶ˆëŸ‰í’ˆëª© ì¬ê³ </h5>
						<div class="clearfix"></div>
					</div>

					<div class="x_content">
					<!-- ì˜¤ë²„í”Œë¡œìš° ë§‰ì„ë ¤ê³  í´ë˜ìŠ¤ ëì— # ë„£ì—ˆìŠµë‹ˆë‹¤  -->
						<div class="table-responsive#">
							<table class="table table-striped jambo_table bulk_action" style="width: 480px">
									<colgroup>
										<col style="width: 40%;" />
										<col style="width: 30%;" />
										<col style="width: 30%;" />
									</colgroup>
								<thead>
									<tr class="headings">
										<th class="column-title">í’ˆëª©ëª…</th>
										<th class="column-title" style="color:red;">ì´ ë¶ˆëŸ‰ìˆ˜ëŸ‰</th>
										<th class="column-title">ë‹¨ ìœ„</th>
									</tr>
								</thead>

								<tbody>
									<tr class="even pointer" th:each="defectiveInfo : ${defectiveListTotal }">
										<td style="vertical-align:middle;text-overflow:ellipsis; overflow:hidden; white-space:nowrap;" th:title="${defectiveInfo.name}" th:text="${defectiveInfo.name}" />
										<td style="vertical-align:middle;text-overflow:ellipsis; overflow:hidden; white-space:nowrap;" th:title="${#numbers.formatInteger(defectiveInfo.defectiveCount, 0, 'COMMA')}" th:text="|${#numbers.formatInteger(defectiveInfo.defectiveCount, 0, 'COMMA')}" />
										<td style="vertical-align:middle" th:text="EA" />
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					
					<!-- í…Œì´ë¸” -->
					<div class="x_title">
						<h5 style="color:black;font-weight: bold;">ğŸŒ½ ë¶ˆëŸ‰í’ˆëª© ì •ë³´</h5>
						<div class="clearfix"></div>
					</div>

					<div class="x_content">
						<div class="table-responsive#">
							<table class="table table-striped jambo_table bulk_action" style="table-layout:fixed;">
									<colgroup>
										<col style="display:none;width:0"/>
										<col style="display:none;width:0"/>
										<col style="width: 15%;" />
										<col style="width: 10%;" />
										<col style="width: 10%;" />
										<col style="width: 10%;" />
										<col style="width: 15%;" />
										<col style="width: 30%;" />
										<col style="width: 10%;" />
									</colgroup>
								<thead>
									<tr class="headings">
										<th style="display:none;"><input type="checkbox" id="check-all" class="flat"></th>
										<th style="display:none;" class="column-title">í’ˆëª©ì½”ë“œ</th>
										<th class="column-title">í’ˆëª©ëª…</th>
										<th  style="color:red;" class="column-title">ë¶ˆëŸ‰ìˆ˜ëŸ‰</th>
										<th class="column-title">ë‹¨ ìœ„</th>
										<th class="column-title">ì…ê³  ë‚ ì§œ</th>
										<th class="column-title">ì°½ ê³ </th>
										<th class="column-title">ë¶ˆëŸ‰ì‚¬ìœ </th>
										<th class="column-title">ìˆ˜ì •/ì‚­ì œ</th>
									</tr>
								</thead>

								<tbody>
									<tr class="even pointer" th:each="defectiveInfo : ${defectiveList }">
										<td style="display:none;" class="a-center"><input type="checkbox" class="flat"name="table_records"></td>
										<td style="display:none;" th:text="${defectiveInfo.itemCode}"/>
										<td style="vertical-align:middle;text-overflow:ellipsis; overflow:hidden; white-space:nowrap;" th:title="${defectiveInfo.name}" th:text="${defectiveInfo.name}"/>
										<td style="vertical-align:middle;text-overflow:ellipsis; overflow:hidden; white-space:nowrap;" th:title="${#numbers.formatInteger(defectiveInfo.defectiveCount, 0, 'COMMA')}" th:text="${#numbers.formatInteger(defectiveInfo.defectiveCount, 0, 'COMMA')}"/>
										<td style="vertical-align:middle" th:text="EA" />
										<td style="vertical-align:middle;text-overflow:ellipsis; overflow:hidden; white-space:nowrap;" th:title="${#dates.format(defectiveInfo.registeDate,'yyyy-MM-dd')}" th:text="${#dates.format(defectiveInfo.registeDate,'yyyy-MM-dd')}"/>
										<td style="vertical-align:middle;text-overflow:ellipsis; overflow:hidden; white-space:nowrap;" th:title="${defectiveInfo.warehouseName}" th:text="${defectiveInfo.warehouseName}"/>
										<td style="vertical-align:middle;text-overflow:ellipsis; overflow:hidden; white-space:nowrap;" th:title="${defectiveInfo.explation}" th:text="${defectiveInfo.explation}"/>
										<td style="vertical-align:middle">
											<button type="button" th:id="updateForm+${defectiveInfo.defectiveNo}" th:onclick="updateForm([[${defectiveInfo.defectiveNo}]])" class="btn btn-warning btn-sm">ìˆ˜ì •</button>
											<button type="button" style="display: none;" th:id="update+${defectiveInfo.defectiveNo}" th:onclick="update([[${defectiveInfo.defectiveNo}]])" class="btn btn-warning btn-sm">ì™„ë£Œ</button>
											<button type="button" style="display: none;" th:id="cancel+${defectiveInfo.defectiveNo}" th:onclick="cancel([[${defectiveInfo.defectiveNo}]])" class="btn btn-primary btn-sm">ì·¨ì†Œ</button>
											<button type="button" th:id="deleteBtn+${defectiveInfo.defectiveNo}" th:onclick="deleteBtn([[${defectiveInfo.defectiveNo}]])" class="btn btn-danger btn-sm">ì‚­ì œ</button>
										</td>
										<td style="display:none;" th:text="${defectiveInfo.cropNo}"/>
										<td style="display:none;" th:text="${defectiveInfo.warehouseCode}"/>
									</tr>
								</tbody>
							</table>
							
							<!--  í˜ì´ì§•  -->
								<div class="pageInfo_area" style="width:100%; text-align: center;">
									<ul class="pagination2 model" th:each="page:${pageInfo}">
										<th:block
											th:with="start = ${page.startPage}, end = ${page.endPage} ">
											
											<!-- ì´ì „ -->
											<li class="pageInfo_btn" th:if="${page.prev}"><a
												class="allowleft"
												th:text="'<'"></a></li>
											<!-- ìˆ«ì -->
											<li class="pageInfo_btn"
												th:with="start = ${page.startPage}, end = ${page.endPage}"
												th:each="pageButton : ${#numbers.sequence(start, end)}">
												<a class="num"
												th:text=${pageButton}
												th:href="@{/defectiveList?pageNum={page}&amount=10 (page = ${pageButton},name = ${pageInfo.cri.name},middleCatagori=${pageInfo.cri.middleCatagori},startDate=${pageInfo.cri.startDate},endDate=${pageInfo.cri.endDate},warehouseCode=${pageInfo.cri.warehouseCode})}"
												th:classappend="${pageInfo.cri.pageNum == pageButton ? 'active':'' }"></a>
											</li>
											<!-- ë‹¤ìŒ -->
											<li class="pageInfo_btn" th:if="${page.next}"><a
												class="arrowright"
												th:text="'>'"></a></li>
											
										</th:block>
									</ul>
								</div>
							
							<form th:action="@{defectiveList }" id="actionForm" method="get">
								<input type="hidden" name="pageNum" th:value="${pageInfo.cri.pageNum }">
								<input type="hidden" name="amount" th:value="${pageInfo.cri.amount }">
								<input type="hidden" name="name" th:value="${pageInfo.cri.name }">
								<input type="hidden" name="middleCatagori" th:value="${pageInfo.cri.middleCatagori }">
								<input type="hidden" name="startDate" th:value="${pageInfo.cri.startDate }">
								<input type="hidden" name="endDate" th:value="${pageInfo.cri.endDate }"> 
								<input type="hidden" name="warehouseCode" th:value="${pageInfo.cri.warehouseCode }">
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- /page content -->
	<script>
		$(document).ready(function(){
			//í˜ì´ì§•
			let actionForm = $("#actionForm");
			console.log(actionForm);
		    $('.paginate_button a').on('click', function (e) {
	        	actionForm.find('input[name="pageNum"]').val($(this).attr('href'))
		    	e.preventDefault();
		        actionForm.submit();
        	})
		    
        	//ê²€ìƒ‰
	        //ê²€ìƒ‰í›„ ê°’ ìœ ì§€
			$('#catagoriSelect').val('[[${param.middleCatagori}]]');
		    $('#cropName').val('[[${param.name}]]');
			$('#startDate').val('[[${param.startDate}]]');
			$('#endDate').val('[[${param.endDate}]]');
			
	        let SearchForm = $("#SearchForm");
		    $("#SearchForm > #searchSubmit").on("click", function(e){
		    	let catagoriSelect = $("#catagoriSelect").val();
				let name = $("#SearchForm input[name='name']").val();
				let warehouseSelect = $("#warehouseSelect").val();
				let startDate = $("#startDate").val();
				let endDate = $("#endDate").val();
				let warehouseName = $("#houseName").val(); 
				
		    	actionForm.find("input[name='middleCatagori']").val(catagoriSelect);
				actionForm.find("input[name='name']").val(name);
				actionForm.find("input[name='warehouseCode']").val(warehouseSelect);
				actionForm.find("input[name='startDate']").val(startDate);
				actionForm.find("input[name='endDate']").val(endDate);
				actionForm.find("input[name='warehouseName']").val(warehouseName);
				actionForm.find("input[name='pageNum']").val(1);
				e.preventDefault();
				actionForm.submit();
		    })
			
		});
		
		//ì´ˆê¸°í™”
		$("#searchReset").on('click', function(e){
			e.preventDefault();
			$("#warehouseSelect").val(0);
			$("#catagoriSelect").val("");
			$("#startDate").val("");
			$("#endDate").val("");
			$("#SearchForm input[name='name']").val("");
			document.getElementById('searchSubmit').click();
		})
		
		//ì¡°íšŒë²„íŠ¼ í´ë¦­ì‹œ ì²´í¬
		function check(){
			let catagoriSelect = $("#catagoriSelect").val();
			let name = $("#SearchForm input[name='name']").val();
			
			//ë¶„ë¥˜ë§Œ ì„ íƒì‹œ ì•Œë¦¼
			if(catagoriSelect){
				if(!name){
					const Toast = Swal.mixin({
	                    toast: true,
	                    position: 'center-center',
	                    showConfirmButton: false,
	                    timer: 500,
	                    timerProgressBar: true,
	                    didOpen: (toast) => {
	                      toast.addEventListener('mouseenter', Swal.stopTimer)
	                      toast.addEventListener('mouseleave', Swal.resumeTimer)
	                    }
	                  })

	                  Toast.fire({
	                    icon: 'warning',
	                    title: 'í’ˆëª©ëª…ì„ ì…ë ¥í•˜ì„¸ìš”.'
	                  })
					return false;
				}
			}
			
			if(name){
				if(!catagoriSelect){
					const Toast = Swal.mixin({
	                    toast: true,
	                    position: 'center-center',
	                    showConfirmButton: false,
	                    timer: 500,
	                    timerProgressBar: true,
	                    didOpen: (toast) => {
	                      toast.addEventListener('mouseenter', Swal.stopTimer)
	                      toast.addEventListener('mouseleave', Swal.resumeTimer)
	                    }
	                  })

	                  Toast.fire({
	                    icon: 'warning',
	                    title: 'ë¶„ë¥˜ë¥¼ ì„ íƒí•˜ì„¸ìš”.'
	                  })
					return false;
				}
			}
			
			//ë‚ ì§œ ë‘˜ë‹¤ ì…ë ¥ ì²´í¬ + ì‹œì‘ì¼ > ì¢…ë£Œì¼ì¸ê²½ìš° ì²´í¬
			var stDt = $('#startDate').val();
		    var edDt = $('#endDate').val();
		    
		    if(stDt == '' && edDt != ''){
		    	const Toast = Swal.mixin({
                    toast: true,
                    position: 'center-center',
                    showConfirmButton: false,
                    timer: 500,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                      toast.addEventListener('mouseenter', Swal.stopTimer)
                      toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                  })

                  Toast.fire({
                    icon: 'warning',
                    title: 'ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ì…ë ¥í•˜ì„¸ìš”.'
                  })
		     	return false;
		    } 
		    
		    if (stDt != '' && edDt == ''){
		    	const Toast = Swal.mixin({
                    toast: true,
                    position: 'center-center',
                    showConfirmButton: false,
                    timer: 500,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                      toast.addEventListener('mouseenter', Swal.stopTimer)
                      toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                  })

                  Toast.fire({
                    icon: 'warning',
                    title: 'ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ì…ë ¥í•˜ì„¸ìš”.'
                  })
			    return false;
		    } 
	    	
		    if( Number(stDt.replace(/-/gi,"")) > Number(edDt.replace(/-/gi,"")) ){
		    	const Toast = Swal.mixin({
                    toast: true,
                    position: 'center-center',
                    showConfirmButton: false,
                    timer: 500,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                      toast.addEventListener('mouseenter', Swal.stopTimer)
                      toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                  })

                  Toast.fire({
                    icon: 'warning',
                    title: 'ì‹œì‘ì¼ì´ ì¢…ë£Œì¼ë³´ë‹¤ í´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'
                  })
		     	return false;
		    }
		}
		
		//í…Œì´ë¸” ìˆ˜ì •,ì‚­ì œ
		let updateFormBtn, updateBtn, trTag, itemCodeTag, itemNameTag, registDateTag,
			defectiveCountTag, unitTag, warehouseNameTag, warehouseCodeTag, explationTag;
		let itemCode, itemName, defectiveCount, warehouseName,
			selectTag, warehouseCode, explation, defectiveCountOr;
		let inpCount, inpItemName, inpItemCode, cropNo, inpExplation;
		let pageNum = [[${pageInfo.cri.pageNum}]];
		
		//ìˆ˜ì •í¼ìœ¼ë¡œ ì „í™˜
		function updateForm(defectiveNo){
			updateFormBtn = document.getElementById('updateForm' + defectiveNo);
	    	updateFormBtn.style.display = 'none';
	    	
	    	deleteBtn = document.getElementById('deleteBtn' + defectiveNo);
	    	deleteBtn.style.display = 'none';
	    	
	    	updateBtn = document.getElementById('update' + defectiveNo);
	    	updateBtn.style.display = 'inline-block';
	    	
	    	cancelBtn = document.getElementById('cancel' + defectiveNo);
	    	cancelBtn.style.display = 'inline-block';
	    	
	    	trTag = updateFormBtn.parentElement.parentElement;
	    	checkBoxTag = trTag.childNodes[1];
	    	itemCodeTag = trTag.childNodes[3];
	    	itemNameTag = trTag.childNodes[5];
	    	defectiveCountTag = trTag.childNodes[7];
	    	unitTag = trTag.childNodes[9];
	    	registDateTag = trTag.childNodes[11];
	    	warehouseNameTag = trTag.childNodes[13];
			explationTag = trTag.childNodes[15];
	    	cropNo = trTag.childNodes[19].textContent;
	    	warehouseCodeTag = trTag.childNodes[21];
	    	
	    	fetch("/ohnong/warehouseList/" + "[[${session.login.userId}]]")
		   	.then(resolve => resolve.json())
		   	.then(result => {
		   		//DefectiveCount
		   		defectiveCount = defectiveCountTag.textContent;
		   		defectiveCountOr = defectiveCountTag.textContent;
		   		defectiveCountTag.innerHTML = '';
		   		
		   		inpCount = document.createElement('input');
		   		inpCount.setAttribute("id","co");
		   		inpCount.addEventListener('input', function(){
		   			let co = $('#co').val();
		   			co = Number(co.replaceAll(',',''));
		   			if(isNaN(co)){
		   				$('#co').val(defectiveCount);
		   			} else {
		   				let formatCo = co.toLocaleString('ko-KR');
		   				$('#co').val(formatCo);
		   			}
		   		});
		   		
		   		inpCount.value = defectiveCount;
		   		inpCount.style.width = '100%';
		   		defectiveCountTag.append(inpCount);
		   		//WarehouseName
		   		warehouseName = warehouseNameTag.textContent;
		   		warehouseCode = warehouseCodeTag.textContent;
		   		warehouseNameTag.innerHTML = '';
		   		
		   		selectTag = document.createElement('select');
				for(let i=0;i<result.length;i++){
					let optionTag = document.createElement('option');
					optionTag.value = result[i].warehouseCode;
					optionTag.innerText = result[i].warehouseName;
					selectTag.append(optionTag);
				}
				selectTag.style.width = '100%';
		   		warehouseNameTag.append(selectTag);
		   		selectTag.value = warehouseCode;
		   		
		   		//Explation
		   		explation = explationTag.textContent;
		   		explationTag.innerHTML = '';
		   		inpExplation = document.createElement('input');
		   		inpExplation.value = explation;
		   		inpExplation.style.width = '100%';
		   		explationTag.append(inpExplation);
		   	})
		   	.catch(reject => console.log(reject))
	    }
		
		//ì·¨ì†Œ
		function cancel(defectiveNo){
			location.reload();
			defectiveCountTag.innerHTML = defectiveCountOr;
	   		warehouseNameTag.innerHTML = warehouseName;
	   		explationTag.innerHTML = explation;
	   		
	   		updateFormBtn = document.getElementById('updateForm' + defectiveNo);
	    	updateFormBtn.style.display = 'inline-block';
	    	
	    	deleteBtn = document.getElementById('deleteBtn' + defectiveNo);
	    	deleteBtn.style.display = 'inline-block';
	    	
	    	updateBtn = document.getElementById('update' + defectiveNo);
	    	updateBtn.style.display = 'none';
	    	
	    	cancelBtn = document.getElementById('cancel' + defectiveNo);
	    	cancelBtn.style.display = 'none';
		}
		
		//ìˆ˜ì •
		function update(defectiveNo){
			let newWarehouseCode = selectTag.value;
			let newWarehouseName = selectTag.options[selectTag.selectedIndex].text;
			let newDefectiveCount = inpCount.value;
			newDefectiveCount = newDefectiveCount.replaceAll(',','');
			let newExplation = inpExplation.value;
			
			$.ajax({
				type : 'post',
				url : '/ohnong/defectiveUpdate',
				dataType : 'text',
				data : {
						"defectiveNo" : defectiveNo,
						"defectiveCount" : newDefectiveCount,
						"warehouseCode" : newWarehouseCode,
						"explation" : newExplation
				},
				success : function(data){
					//itemCodeTag.innerText = newItemCode;
					//itemNameTag.innerText = newItemName;
					//countTag.innerText = newCount;
					//warehouseNameTag.innerText = newWarehouseName;
			    	//updateFormBtn.style.display = 'inline-block';
			    	//updateBtn.style.display = 'none';
					const Toast = Swal.mixin({
	                    toast: true,
	                    position: 'center-center',
	                    showConfirmButton: false,
	                    timer: 500,
	                    timerProgressBar: true,
	                    didOpen: (toast) => {
	                      toast.addEventListener('mouseenter', Swal.stopTimer)
	                      toast.addEventListener('mouseleave', Swal.resumeTimer)
	                    }
	                  })

	                  Toast.fire({
	                    icon: 'success',
	                    title: 'ìˆ˜ì • ë˜ì—ˆìŠµë‹ˆë‹¤.'
	                  })
					setTimeout(function(){location.reload()}, 500);
				},
				error : function(status, error){
					console.log(status, error);
				}
			})
			
		}
		
		//ì‚­ì œ
		function deleteBtn(defectiveNo){
			let deleteBtn = document.getElementById('deleteBtn' + defectiveNo);
			let delTrTag = deleteBtn.parentElement.parentElement;
			
			Swal.fire({
	            title: 'ì‚­ì œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
	            icon: 'warning',
	            showCancelButton: true,
	            confirmButtonColor: '#3085d6',
	            cancelButtonColor: '#d33',
	            confirmButtonText: 'í™•ì¸',
	            cancelButtonText: 'ì·¨ì†Œ'
	        }).then((result) => {
	            if (result.isConfirmed) {
	            	$.ajax({
						type : 'get',
						url : "/ohnong/defectiveDelete/" + defectiveNo,
						dataType : 'text',
						success : function(data){
							console.log(data);
							if(data == 'success'){
								//delTrTag.remove();
								location.reload();
								const Toast = Swal.mixin({
				                    toast: true,
				                    position: 'center-center',
				                    showConfirmButton: false,
				                    timer: 500,
				                    timerProgressBar: true,
				                    didOpen: (toast) => {
				                      toast.addEventListener('mouseenter', Swal.stopTimer)
				                      toast.addEventListener('mouseleave', Swal.resumeTimer)
				                    }
				                  })

				                  Toast.fire({
				                    icon: 'warning',
				                    title: 'ë¶ˆëŸ‰ë‚´ì—­ì´ ì‚­ì œ ë˜ì—ˆìŠµë‹ˆë‹¤.'
				                  })
							} else if(data = 'fail'){
								const Toast = Swal.mixin({
				                    toast: true,
				                    position: 'center-center',
				                    showConfirmButton: false,
				                    timer: 500,
				                    timerProgressBar: true,
				                    didOpen: (toast) => {
				                      toast.addEventListener('mouseenter', Swal.stopTimer)
				                      toast.addEventListener('mouseleave', Swal.resumeTimer)
				                    }
				                  })

				                  Toast.fire({
				                    icon: 'warning',
				                    title: 'ì˜¤ë¥˜.'
				                  })
							}
						},
						error : function(status, error){
							console.log(status, error);
						}
					})
			     }
		    })
		}		
	</script>
</div>



