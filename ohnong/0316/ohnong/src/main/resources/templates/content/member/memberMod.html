<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout/layoutMagement}">
<head>
<meta charset="UTF-8">
<title>oh-nong!</title>
<style>
.find-btn{
    text-align: center;
}
.find-btn1{
    display :inline-block;
}
.label-align {
    text-align: left;
}
</style>
</head>
</th:block>
<th:block layout:fragment="script">
</th:block>
<div layout:fragment="contentMagement">

    <div class="right_col" role="main">
        <div class="">
            <div class="page-title">
                <div class="title_left">
                </div>
            </div>

            <div class="clearfix"></div>

            <div class="row">
                <div class="col-md-12 col-sm-12 ">
                <h3 style="text-align:left"><b>ğŸ‘¨â€ğŸŒ¾ ì •ë³´ ìˆ˜ì •</b></h3>
                    <div class="x_panel">
                        <div class="x_title">
                            <ul class="nav navbar-right panel_toolbox">
                                <li><a class="collapse-link"><i
                                        class="fa fa-chevron-up"></i></a></li>
                                <li class="dropdown"><a href="#" class="dropdown-toggle"
                                    data-toggle="dropdown" role="button" aria-expanded="false"><i
                                        class="fa fa-wrench"></i></a>
                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                        <a class="dropdown-item" href="#">Settings 1</a> <a
                                            class="dropdown-item" href="#">Settings 2</a>
                                    </div></li>
                                <li><a class="close-link"><i class="fa fa-close"></i></a></li>
                            </ul>
                            <div class="clearfix"></div>
                        </div>
                        <div class="x_content">
                                <form name="form" th:role="form" th:action="@{memberMod}" method="POST" enctype="multipart/form-data" >
                                 <table>
                                        <tbody>
                                            <tr th:each="memberInfo : ${memberList}">
                            <div class="col-md-3 col-sm-3  profile_left">
                                <div class="profile_img">
                                    <div id="crop-avatar">
                                        <!-- Current avatar -->
                                        <img class="img-responsive avatar-view" id="fileName" name ="fileName"
                                            th:src="|/ohnong/home/ubuntu/etc/${memberInfo.filePath}|" alt="Avatar"
                                            title="Change the avatar"
                                            style="max-width: 70%; height: auto;">
                                    </div>
                                    <br>
                                    	
                                        <label for="profileImg1"><a class="btn btn-success" style="color:white; margin: 0 50px;"><i class="fa fa-edit m-right-xs"></i><b>í”„ë¡œí•„ ì‚¬ì§„ ë“±ë¡</b></a></label> 
                                        <input type="file" id="profileImg1" name="profileImg1" onchange="profileImg()" style="display:none" th:value="${memberInfo.filePath}">
                                        <br>
                                </div>
                                        <button type="button" class="btn btn-danger" id="pwModBtn" style="color:white; margin: 0 50px; width: 153px"><i class="fa fa-ban"></i><b>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</b></button>                              		
                                <br>
                            </div>
                            <div class="col-md-9 col-sm-9 ">                            
                                   
                                                <div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>ì•„ì´ë””</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="form-control"
                                                            th:value="${memberInfo.userId}" id="userId" name="userId" readonly />
                                                    </div>
                                                </div>
                                                <br>

												<div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>ì´ë¦„</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="form-control"
                                                            th:value="${memberInfo.Name}" readonly />
                                                    </div>
                                                </div>
                                                <br>

                                                <div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>ì£¼ì†Œ</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="col-md-10 col-sm-12 form-control"
                                                            th:value="${memberInfo.userAddr}" id="userAddr" name="userAddr" />
                                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                        <button type="button" class="btn btn-success"  th:onclick="execDaumPostcode()"><b>ê²€ìƒ‰</b></button>
                                                    </div>
                                                </div>
                                                <br>
                                                
                                                <div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>ì´ë©”ì¼</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="col-md-12 col-sm-12 form-control email"
                                                            th:value="${memberInfo.userEmail}" id="userEmail" name="userEmail" required="required"
                                                            type="email" />
                                                    </div>
                                                </div>
                                                <br>

                                                <div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>ìƒë…„ì›”ì¼</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="form-control date"
                                                            th:value="${memberInfo.birth}" readonly>
                                                    </div>
                                                </div>
                                                <br>
                                                
                                                <div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>ì—°ë½ì²˜</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="form-control tel" type="tel"
                                                            th:value="${memberInfo.userTel}" id="userTel" name="userTel" required='required' />
                                                    </div>
                                                    <p id="telChk"></p>
                                                </div>
                                                <br>                                         

                                                <div class="ln_solid">
                                                    <br>
                                                    <div class="form-group">
                                                        <div class="col-md-6 offset-md-3">
                                                            <button id="submit" type='submit' class="btn btn-primary"><b>ìˆ˜ì •</b></button>
                                                            <button type='reset' class="btn btn-dark"><b>ì·¨ì†Œ</b></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </tr>
                                        <tbody>
                                    </table>
                                </form>
                            </div>
                            
  <!-- insert modal 1 -->
  <div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <form name="form" th:role="form" th:action="@{modPw}" method="POST">
      <div class="modal-content" style="border: none;">
        <div class="modal-header" style="display: flex; align-items: center; justify-content: space-between; width:100%;height:50px; background-color: #2A3F54;">
          	<h5 class="modal-title" id="myModalLabel" style="color:white; font-weight: bold; "> ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</h5>
          	<button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="color:white;">Ã—</button>
        </div>
        <div class="modal-body">
        
          <input type="hidden" class="form-control" name="userId" th:value="${session.login.userId}" />
          <table>
            <tbody>
            	<tr th:each="memberInfo : ${memberList}">
            		<div class="form-group">
              			<label style="color:black; margin-left: 5px; font-size: 14px; font-weight: bold;">ë¹„ë°€ë²ˆí˜¸<span
                                                        class="required">*</span></label>
             			<input class="form-control" type="password" id="userPw2" name="userPw2" placeholder="ë¬¸ì, ìˆ«ì, ê¸°í˜¸ë¥¼ ì¡°í•©í•˜ì—¬ 10ì ì´ìƒ ì…ë ¥" />
            		</div>
            		<p id="pwChk"></p>
            
		            <div class="form-group">
		              <label style="color:black; margin-left: 5px; font-size: 14px; font-weight: bold;">ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥<span
		                                                        class="required">*</span></label>
		              <input class="form-control" type="password"
		                                                            id="userPwChk" name="userPwChk" placeholder="ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥"/>
		              <input type="hidden" id="userPw" name="userPw" th:value="${memberInfo.userPw}"/>
		            </div>
					<p id="pwChk2"></p>
				</tr>
			  </tbody>
			</table>
        </div>
        
        <div class="modal-footer" style="display: flex; align-items: center; justify-content: flex-end; width:100%;height:50px; background-color: #2A3F54;">
          <button id="modalModBtn" type="submit" class="btn btn-warning" style="border: none; font-weight: bold; color:white; background: #035785; height: 30px;">ìˆ˜ì •</button>
        </div>
      </div>
    </form>
    </div>
  </div>
  <!-- /insert modal -->
  
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>
function hideshow(){
    var password = document.getElementById("userPw");
    var slash = document.getElementById("slash");
    var eye = document.getElementById("eye");
    
    if(password.type === 'password'){
        password.type = "text";
        slash.style.display = "block";
        eye.style.display = "none";
    }
    else{
        password.type = "password";
        slash.style.display = "none";
        eye.style.display = "block";
    }
}
    
    // ì£¼ì†Œ API
    function execDaumPostcode() {
        console.log('test');

        new daum.Postcode({
            oncomplete: function(data) {
                // íŒì—…ì—ì„œ ê²€ìƒ‰ê²°ê³¼ í•­ëª©ì„ í´ë¦­í–ˆì„ë•Œ ì‹¤í–‰í•  ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ë¶€ë¶„.

                // ë„ë¡œëª… ì£¼ì†Œì˜ ë…¸ì¶œ ê·œì¹™ì— ë”°ë¼ ì£¼ì†Œë¥¼ í‘œì‹œí•œë‹¤.
                // ë‚´ë ¤ì˜¤ëŠ” ë³€ìˆ˜ê°€ ê°’ì´ ì—†ëŠ” ê²½ìš°ì—” ê³µë°±('')ê°’ì„ ê°€ì§€ë¯€ë¡œ, ì´ë¥¼ ì°¸ê³ í•˜ì—¬ ë¶„ê¸° í•œë‹¤.
                var roadAddr = data.roadAddress; // ë„ë¡œëª… ì£¼ì†Œ ë³€ìˆ˜
                var extraRoadAddr = ''; // ì°¸ê³  í•­ëª© ë³€ìˆ˜

                // ë²•ì •ë™ëª…ì´ ìˆì„ ê²½ìš° ì¶”ê°€í•œë‹¤. (ë²•ì •ë¦¬ëŠ” ì œì™¸)
                // ë²•ì •ë™ì˜ ê²½ìš° ë§ˆì§€ë§‰ ë¬¸ìê°€ "ë™/ë¡œ/ê°€"ë¡œ ëë‚œë‹¤.
                if(data.bname !== '' && /[ë™|ë¡œ|ê°€]$/g.test(data.bname)){
                    extraRoadAddr += data.bname;
                }
                // ê±´ë¬¼ëª…ì´ ìˆê³ , ê³µë™ì£¼íƒì¼ ê²½ìš° ì¶”ê°€í•œë‹¤.
                if(data.buildingName !== '' && data.apartment === 'Y'){
                   extraRoadAddr += (extraRoadAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                }
                // í‘œì‹œí•  ì°¸ê³ í•­ëª©ì´ ìˆì„ ê²½ìš°, ê´„í˜¸ê¹Œì§€ ì¶”ê°€í•œ ìµœì¢… ë¬¸ìì—´ì„ ë§Œë“ ë‹¤.
                if(extraRoadAddr !== ''){
                    extraRoadAddr = ' (' + extraRoadAddr + ')';
                }

                // ìš°í¸ë²ˆí˜¸ì™€ ì£¼ì†Œ ì •ë³´ë¥¼ í•´ë‹¹ í•„ë“œì— ë„£ëŠ”ë‹¤.
                //document.getElementById('sample4_postcode').value = data.zonecode;
                document.getElementById("userAddr").value = roadAddr;
                //document.getElementById("sample4_jibunAddress").value = data.jibunAddress;
            }
        }).open();
    }
    
    $(document).ready(function () {
    	
        const getPwCheck = RegExp(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/);
        
        // ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ê°’ ìœ íš¨ì„± ê²€ì‚¬
        $('#userPw2').keyup(function() {
            if(!getPwCheck.test($(this).val()) || $(this).val().length < 10 ) {
                $(this).css('background-color', 'pink');
                $('#pwChk').html('<b style="font-size: 14px; color: red">[ë¬¸ì, ìˆ«ì, ê¸°í˜¸ë¥¼ ì¡°í•©í•˜ì—¬ 10ì ì´ìƒ ì…ë ¥í•˜ì„¸ìš”.]</b>');
                false;
            } else {
                $(this).css('background-color', 'white');
                $('#pwChk').html('<b style="font-size: 14px; color: green">[ì‚¬ìš© ê°€ëŠ¥í•œ ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.]</b>');
                true;
            }
        })
        
        // ë¹„ë°€ë²ˆí˜¸ í™•ì¸
        $('#userPwChk').keyup(function() {
            if($(this).val() === '') {
                $(this).css('background-color', 'pink');
                $('#pwChk2').html('<b style="font-size: 14px; color: red">[ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.]</b>');
                false;
            } else if($(this).val() != $('#userPw2').val()) {
                $(this).css('background-color', 'pink');
                $('#pwChk2').html('<b style="font-size: 14px; color: red">[ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.]</b>');
                false;
            } else {
                $(this).css('background-color', 'white');
                $('#pwChk2').html('<b style="font-size: 14px; color: green">[ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.]</b>');
                var userPwChk = $('#userPwChk').val(); // ë‹¤ì‹œ ì…‹íŒ…í•˜ê¸°
                $('#userPw').val(userPwChk);
                true;
            }
        })

        // ì—°ë½ì²˜
        $('#userTel').keyup(function() {
            $(this).val( $(this).val().replace(/[^0-9]/g, "").replace(/(^02|^0505|^1[0-9]{3}|^0[0-9]{2})([0-9]+)?([0-9]{4})$/,"$1-$2-$3").replace("--", "-"));
            
            if($(this).val().length > 13 ) {
                $(this).css('background-color', 'pink');
                $('#telChk').html('<b style="font-size: 14px; color: red">[ì…ë ¥ê°’ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.]</b>');
                chk5 = false;
            } else {
                $(this).css('background-color', 'white');
                $('#telChk').html('');
                chk5 = true;
            }
        }) 
    })
    
    // íŒŒì¼ ì‚¬ì´ì¦ˆ, íƒ€ì… ì œí•œ
	var regex = new RegExp("(.*?)\.(exe|sh|zip|alz)$");
	var maxSize = 5242880;

	function checkExtension(fileName, fileSize) {
		if (fileSize >= maxSize) {
			alert("íŒŒì¼ ì‚¬ì´ì¦ˆ ì´ˆê³¼");
			return false;
		}

		if (regex.test(fileName)) {
			alert("í•´ë‹¹ ì¢…ë¥˜ì˜ íŒŒì¼ì€ ì—…ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
			return false;
		}
		return true;
	}
	
	function profileImg() {
		var preview = document.getElementById('fileName');
        var file = document.getElementById('profileImg1').files[0];
        var reader = new FileReader();
        
        console.log(preview);
        console.log(file);

        reader.onloadend = function() {
            preview.src = reader.result;
        }
        if (file) {
            reader.readAsDataURL(file);
        } else {
            preview.src = "";
        }
	}
	
	// ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ë²„íŠ¼
    $('#pwModBtn').on("click", function() {
    	$('#myModal').modal("show");
    })
	
</script>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</html>