<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout/layoutMagement}">
<head>
<meta charset="UTF-8">
<title>oh-nong!</title>
<style>
.find-btn{
    text-align: center;
}
.find-btn1{
    display :inline-block;
}
.label-align {
    text-align: left;
}
</style>
</head>
</th:block>
<th:block layout:fragment="script">
</th:block>
<div layout:fragment="contentMagement">

    <div class="right_col" role="main">
        <div class="">
            <div class="page-title">
                <div class="title_left">
                </div>
            </div>

            <div class="clearfix"></div>

            <div class="row">
                <div class="col-md-12 col-sm-12 ">
                <h3 style="text-align:left"><b>üë®‚Äçüåæ Ï†ïÎ≥¥ ÏàòÏ†ï</b></h3>
                    <div class="x_panel">
                        <div class="x_title">
                            <ul class="nav navbar-right panel_toolbox">
                                <li><a class="collapse-link"><i
                                        class="fa fa-chevron-up"></i></a></li>
                                <li class="dropdown"><a href="#" class="dropdown-toggle"
                                    data-toggle="dropdown" role="button" aria-expanded="false"><i
                                        class="fa fa-wrench"></i></a>
                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                        <a class="dropdown-item" href="#">Settings 1</a> <a
                                            class="dropdown-item" href="#">Settings 2</a>
                                    </div></li>
                                <li><a class="close-link"><i class="fa fa-close"></i></a></li>
                            </ul>
                            <div class="clearfix"></div>
                        </div>
                        <div class="x_content">
                                <form name="form" th:role="form" th:action="@{memberMod}" method="POST" enctype="multipart/form-data" >
                                 <table>
                                        <tbody>
                                            <tr th:each="memberInfo : ${memberList}">
                            <div class="col-md-3 col-sm-3  profile_left">
                                <div class="profile_img">
                                    <div id="crop-avatar">
                                        <!-- Current avatar -->
                                        <img class="img-responsive avatar-view" id="fileName" name ="fileName"
                                            th:src="|/ohnong/home/ubuntu/etc/${memberInfo.filePath}|" alt="Avatar"
                                            title="Change the avatar"
                                            style="max-width: 70%; height: auto;">
                                    </div>
                                    <br>
                                    	
                                        <label for="profileImg1"><a class="btn btn-success" style="color:white; margin: 0 50px;"><i class="fa fa-edit m-right-xs"></i><b>ÌîÑÎ°úÌïÑ ÏÇ¨ÏßÑ Îì±Î°ù</b></a></label> 
                                        <input type="file" id="profileImg1" name="profileImg1" onchange="profileImg()" style="display:none" th:value="${memberInfo.filePath}">
                                        <br>
                                </div>
                                        <button type="button" class="btn btn-danger" id="pwModBtn" style="color:white; margin: 0 50px; width: 153px"><i class="fa fa-ban"></i><b>ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω</b></button>                              		
                                <br>
                            </div>
                            <div class="col-md-9 col-sm-9 ">                            
                                   
                                                <div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>ÏïÑÏù¥Îîî</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="form-control"
                                                            th:value="${memberInfo.userId}" id="userId" name="userId" readonly />
                                                    </div>
                                                </div>
                                                <br>

												<div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>Ïù¥Î¶Ñ</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="form-control"
                                                            th:value="${memberInfo.Name}" readonly />
                                                    </div>
                                                </div>
                                                <br>

                                                <div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>Ï£ºÏÜå</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="col-md-10 col-sm-12 form-control"
                                                            th:value="${memberInfo.userAddr}" id="userAddr" name="userAddr" />
                                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                        <button type="button" class="btn btn-success"  th:onclick="execDaumPostcode()"><b>Í≤ÄÏÉâ</b></button>
                                                    </div>
                                                </div>
                                                <br>
                                                
                                                <div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>Ïù¥Î©îÏùº</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="col-md-12 col-sm-12 form-control email"
                                                            th:value="${memberInfo.userEmail}" id="userEmail" name="userEmail" required="required"
                                                            type="email" />
                                                    </div>
                                                </div>
                                                <br>

                                                <div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>ÏÉùÎÖÑÏõîÏùº</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="form-control date"
                                                            th:value="${memberInfo.birth}" readonly>
                                                    </div>
                                                </div>
                                                <br>
                                                
                                                <div class="field item form-group">
                                                    <label class="col-form-label col-md-1 col-sm-3 label-align"><b>Ïó∞ÎùΩÏ≤ò</b><span
                                                        class="required">*</span></label>
                                                    <div class="col-md-6 col-sm-6">
                                                        <input class="form-control tel" type="tel"
                                                            th:value="${memberInfo.userTel}" id="userTel" name="userTel" required='required' />
                                                    </div>
                                                    <p id="telChk"></p>
                                                </div>
                                                <br>                                         

                                                <div class="ln_solid">
                                                    <br>
                                                    <div class="form-group">
                                                        <div class="col-md-6 offset-md-3">
                                                            <button id="submit" type='submit' class="btn btn-primary"><b>ÏàòÏ†ï</b></button>
                                                            <button type='reset' class="btn btn-dark"><b>Ï∑®ÏÜå</b></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </tr>
                                        <tbody>
                                    </table>
                                </form>
                            </div>
                            
  <!-- insert modal 1 -->
  <div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <form name="form" th:role="form" th:action="@{modPw}" method="POST">
      <div class="modal-content" style="border: none;">
        <div class="modal-header" style="display: flex; align-items: center; justify-content: space-between; width:100%;height:50px; background-color: #2A3F54;">
          	<h5 class="modal-title" id="myModalLabel" style="color:white; font-weight: bold; "> ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω</h5>
          	<button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="color:white;">√ó</button>
        </div>
        <div class="modal-body">
        
          <input type="hidden" class="form-control" name="userId" th:value="${session.login.userId}" />
          <table>
            <tbody>
            	<tr th:each="memberInfo : ${memberList}">
            		<div class="form-group">
              			<label style="color:black; margin-left: 5px; font-size: 14px; font-weight: bold;">ÎπÑÎ∞ÄÎ≤àÌò∏<span
                                                        class="required">*</span></label>
             			<input class="form-control" type="password" id="userPw2" name="userPw2" placeholder="Î¨∏Ïûê, Ïà´Ïûê, Í∏∞Ìò∏Î•º Ï°∞Ìï©ÌïòÏó¨ 10Ïûê Ïù¥ÏÉÅ ÏûÖÎ†•" />
            		</div>
            		<p id="pwChk"></p>
            
		            <div class="form-group">
		              <label style="color:black; margin-left: 5px; font-size: 14px; font-weight: bold;">ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏûÖÎ†•<span
		                                                        class="required">*</span></label>
		              <input class="form-control" type="password"
		                                                            id="userPwChk" name="userPwChk" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏûÖÎ†•"/>
		              <input type="hidden" id="userPw" name="userPw" th:value="${memberInfo.userPw}"/>
		            </div>
					<p id="pwChk2"></p>
				</tr>
			  </tbody>
			</table>
        </div>
        
        <div class="modal-footer" style="display: flex; align-items: center; justify-content: flex-end; width:100%;height:50px; background-color: #2A3F54;">
          <button id="modalModBtn" type="submit" class="btn btn-warning" style="border: none; font-weight: bold; color:white; background: #035785; height: 30px;">ÏàòÏ†ï</button>
        </div>
      </div>
    </form>
    </div>
  </div>
  <!-- /insert modal -->
  
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>
function hideshow(){
    var password = document.getElementById("userPw");
    var slash = document.getElementById("slash");
    var eye = document.getElementById("eye");
    
    if(password.type === 'password'){
        password.type = "text";
        slash.style.display = "block";
        eye.style.display = "none";
    }
    else{
        password.type = "password";
        slash.style.display = "none";
        eye.style.display = "block";
    }
}
    
    // Ï£ºÏÜå API
    function execDaumPostcode() {
        console.log('test');

        new daum.Postcode({
            oncomplete: function(data) {
                // ÌåùÏóÖÏóêÏÑú Í≤ÄÏÉâÍ≤∞Í≥º Ìï≠Î™©ÏùÑ ÌÅ¥Î¶≠ÌñàÏùÑÎïå Ïã§ÌñâÌï† ÏΩîÎìúÎ•º ÏûëÏÑ±ÌïòÎäî Î∂ÄÎ∂Ñ.

                // ÎèÑÎ°úÎ™Ö Ï£ºÏÜåÏùò ÎÖ∏Ï∂ú Í∑úÏπôÏóê Îî∞Îùº Ï£ºÏÜåÎ•º ÌëúÏãúÌïúÎã§.
                // ÎÇ¥Î†§Ïò§Îäî Î≥ÄÏàòÍ∞Ä Í∞íÏù¥ ÏóÜÎäî Í≤ΩÏö∞Ïóî Í≥µÎ∞±('')Í∞íÏùÑ Í∞ÄÏßÄÎØÄÎ°ú, Ïù¥Î•º Ï∞∏Í≥†ÌïòÏó¨ Î∂ÑÍ∏∞ ÌïúÎã§.
                var roadAddr = data.roadAddress; // ÎèÑÎ°úÎ™Ö Ï£ºÏÜå Î≥ÄÏàò
                var extraRoadAddr = ''; // Ï∞∏Í≥† Ìï≠Î™© Î≥ÄÏàò

                // Î≤ïÏ†ïÎèôÎ™ÖÏù¥ ÏûàÏùÑ Í≤ΩÏö∞ Ï∂îÍ∞ÄÌïúÎã§. (Î≤ïÏ†ïÎ¶¨Îäî Ï†úÏô∏)
                // Î≤ïÏ†ïÎèôÏùò Í≤ΩÏö∞ ÎßàÏßÄÎßâ Î¨∏ÏûêÍ∞Ä "Îèô/Î°ú/Í∞Ä"Î°ú ÎÅùÎÇúÎã§.
                if(data.bname !== '' && /[Îèô|Î°ú|Í∞Ä]$/g.test(data.bname)){
                    extraRoadAddr += data.bname;
                }
                // Í±¥Î¨ºÎ™ÖÏù¥ ÏûàÍ≥†, Í≥µÎèôÏ£ºÌÉùÏùº Í≤ΩÏö∞ Ï∂îÍ∞ÄÌïúÎã§.
                if(data.buildingName !== '' && data.apartment === 'Y'){
                   extraRoadAddr += (extraRoadAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                }
                // ÌëúÏãúÌï† Ï∞∏Í≥†Ìï≠Î™©Ïù¥ ÏûàÏùÑ Í≤ΩÏö∞, Í¥ÑÌò∏ÍπåÏßÄ Ï∂îÍ∞ÄÌïú ÏµúÏ¢Ö Î¨∏ÏûêÏó¥ÏùÑ ÎßåÎì†Îã§.
                if(extraRoadAddr !== ''){
                    extraRoadAddr = ' (' + extraRoadAddr + ')';
                }

                // Ïö∞Ìé∏Î≤àÌò∏ÏôÄ Ï£ºÏÜå Ï†ïÎ≥¥Î•º Ìï¥Îãπ ÌïÑÎìúÏóê ÎÑ£ÎäîÎã§.
                //document.getElementById('sample4_postcode').value = data.zonecode;
                document.getElementById("userAddr").value = roadAddr;
                //document.getElementById("sample4_jibunAddress").value = data.jibunAddress;
            }
        }).open();
    }
    
    $(document).ready(function () {
    	
        const getPwCheck = RegExp(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/);
        
        // ÎπÑÎ∞ÄÎ≤àÌò∏ ÏûÖÎ†•Í∞í Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
        $('#userPw2').keyup(function() {
            if(!getPwCheck.test($(this).val()) || $(this).val().length < 10 ) {
                $(this).css('background-color', 'pink');
                $('#pwChk').html('<b style="font-size: 14px; color: red">[Î¨∏Ïûê, Ïà´Ïûê, Í∏∞Ìò∏Î•º Ï°∞Ìï©ÌïòÏó¨ 10Ïûê Ïù¥ÏÉÅ ÏûÖÎ†•ÌïòÏÑ∏Ïöî.]</b>');
                false;
            } else {
                $(this).css('background-color', 'white');
                $('#pwChk').html('<b style="font-size: 14px; color: green">[ÏÇ¨Ïö© Í∞ÄÎä•Ìïú ÎπÑÎ∞ÄÎ≤àÌò∏ÏûÖÎãàÎã§.]</b>');
                true;
            }
        })
        
        // ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏
        $('#userPwChk').keyup(function() {
            if($(this).val() === '') {
                $(this).css('background-color', 'pink');
                $('#pwChk2').html('<b style="font-size: 14px; color: red">[ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏ÏùÄ ÌïÑÏàòÏûÖÎãàÎã§.]</b>');
                false;
            } else if($(this).val() != $('#userPw2').val()) {
                $(this).css('background-color', 'pink');
                $('#pwChk2').html('<b style="font-size: 14px; color: red">[ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§.]</b>');
                false;
            } else {
                $(this).css('background-color', 'white');
                $('#pwChk2').html('<b style="font-size: 14px; color: green">[ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÏùºÏπòÌï©ÎãàÎã§.]</b>');
                var userPwChk = $('#userPwChk').val(); // Îã§Ïãú ÏÖãÌåÖÌïòÍ∏∞
                $('#userPw').val(userPwChk);
                true;
            }
        })

        // Ïó∞ÎùΩÏ≤ò
        $('#userTel').keyup(function() {
            $(this).val( $(this).val().replace(/[^0-9]/g, "").replace(/(^02|^0505|^1[0-9]{3}|^0[0-9]{2})([0-9]+)?([0-9]{4})$/,"$1-$2-$3").replace("--", "-"));
            
            if($(this).val().length > 13 ) {
                $(this).css('background-color', 'pink');
                $('#telChk').html('<b style="font-size: 14px; color: red">[ÏûÖÎ†•Í∞íÏùÑ ÌôïÏù∏Ìï¥ Ï£ºÏÑ∏Ïöî.]</b>');
                chk5 = false;
            } else {
                $(this).css('background-color', 'white');
                $('#telChk').html('');
                chk5 = true;
            }
        }) 
    })
    
    // ÌååÏùº ÏÇ¨Ïù¥Ï¶à, ÌÉÄÏûÖ Ï†úÌïú
	var regex = new RegExp("(.*?)\.(exe|sh|zip|alz)$");
	var maxSize = 5242880;

	function checkExtension(fileName, fileSize) {
		if (fileSize >= maxSize) {
			alert("ÌååÏùº ÏÇ¨Ïù¥Ï¶à Ï¥àÍ≥º");
			return false;
		}

		if (regex.test(fileName)) {
			alert("Ìï¥Îãπ Ï¢ÖÎ•òÏùò ÌååÏùºÏùÄ ÏóÖÎ°úÎìúÌï† Ïàò ÏóÜÏäµÎãàÎã§.");
			return false;
		}
		return true;
	}
	
	function profileImg() {
		var preview = document.getElementById('fileName');
        var file = document.getElementById('profileImg1').files[0];
        var reader = new FileReader();
        
        console.log(preview);
        console.log(file);

        reader.onloadend = function() {
            preview.src = reader.result;
        }
        if (file) {
            reader.readAsDataURL(file);
        } else {
            preview.src = "";
        }
	}
	
	// ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω Î≤ÑÌäº
    $('#pwModBtn').on("click", function() {
    	$('#myModal').modal("show");
    })
	
</script>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</html>